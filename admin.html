<!DOCTYPE html>
<html>
<head>
  <title>The Traitors â€“ Admin</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="center">

<div class="panel" id="admin"></div>

<script>
function load() {
  return JSON.parse(localStorage.getItem("gameState"));
}
function save(s) {
  localStorage.setItem("gameState", JSON.stringify(s));
}

function render() {
  const a = document.getElementById("admin");
  const s = load();
  a.innerHTML = "<h2>ADMIN PANEL</h2>";

  if (!s) {
    a.innerHTML += `
      <p>No active game</p>
      <a href="index.html"><button>BACK TO HOME</button></a>
    `;
    return;
  }

  a.innerHTML += `
    <button onclick="pause()">PAUSE</button>
    <button onclick="resume()">RESUME</button>
    <button onclick="reset()">RESET GAME</button>
    <a href="index.html"><button>BACK TO HOME</button></a>
    <h3>PLAYERS</h3>
  `;

  s.players.forEach(p => {
    const b = document.createElement("button");
    b.textContent = `${p.name || "Player " + p.id} (${p.alive ? "ALIVE" : "DEAD"})`;
    b.onclick = () => kill(p.id);
    a.appendChild(b);
  });
}

function pause() {
  const s = load();
  s.phase = "PAUSED";
  save(s);
}
function resume() {
  const s = load();
  s.phase = "MENU";
  save(s);
}
function reset() {
  if (confirm("Are you sure you want to reset the entire game? This cannot be undone.")) {
    localStorage.removeItem("gameState");
    render();
    alert("Game has been reset!");
  }
}
function kill(id) {
  const s = load();
  const p = s.players.find(p => p.id === id);
  p.alive = false;
  save(s);
}

window.addEventListener("storage", render);
render();
</script>

</body>
</html>
